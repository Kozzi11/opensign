#ifndef _CONVERSION_H
#define _CONVERSION_H
#if __GNUC__ >=3
#pragma GCC system_header
#endif

#include <Windows.h>
#include <wincrypt.h>
#include <jni.h>
#include "global.h"

#ifdef __cplusplus
extern "C" {
#endif

  jobjectArray certificateList2jobjectArray(JNIEnv*, struct certificate_data*);
  int jbyteArray2pbyte(JNIEnv*, jbyteArray, BYTE**, DWORD*);
  int pbyte2jbyteArray(JNIEnv*, BYTE*, DWORD, jbyteArray*);
  int pchar2jstring(JNIEnv*, char*, jstring*);
  int wchar2jstring(JNIEnv*, WCHAR*, DWORD, jstring*);
  int filetime2jlong(JNIEnv*, FILETIME, jlong*);
  int cryptintegerblob2jbyteArray(JNIEnv*, CRYPT_INTEGER_BLOB, jbyteArray*);
  int keyUsage2jint(JNIEnv *env, byte* keyUsage, jint* jKeyUsage);

#ifdef __cplusplus
}
#endif
#endif
