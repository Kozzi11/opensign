/* XMLEntityResolver.java                                          NanoXML/Java
 *
 * $Revision: 1.2 $
 * $Date: 2012/02/28 08:21:25 $
 * $Name:  $
 *
 * This file is part of NanoXML 2 for Java.
 * Copyright (C) 2000-2002 Marc De Scheemaecker, All Rights Reserved.
 *
 * This software is provided 'as-is', without any express or implied warranty.
 * In no event will the authors be held liable for any damages arising from the
 * use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 *  1. The origin of this software must not be misrepresented; you must not
 *     claim that you wrote the original software. If you use this software in
 *     a product, an acknowledgment in the product documentation would be
 *     appreciated but is not required.
 *
 *  2. Altered source versions must be plainly marked as such, and must not be
 *     misrepresented as being the original software.
 *
 *  3. This notice may not be removed or altered from any source distribution.
 */

/* $Id: XMLEntityResolver.java,v 1.2 2012/02/28 08:21:25 pakj Exp $ */

package org.openoces.opensign.xml.nanoxml;


import java.util.HashMap;
import java.io.Reader;
import java.io.StringReader;
import java.util.Map;


/**
 * An XMLEntityResolver resolves entities.
 *
 * @author Marc De Scheemaecker
 * @version $Name:  $, $Revision: 1.2 $
 */
final class XMLEntityResolver
{

   /**
    * The entities.
    */
   private Map entities;


   /**
    * Initializes the resolver.
    */
   public XMLEntityResolver()
   {
      entities = new HashMap();
      entities.put("Aacute","&#193;");
      entities.put("aacute","&#225;");
      entities.put("Acirc","&#194;");
      entities.put("acirc","&#226;");
      entities.put("AElig","&#198;");
      entities.put("aelig","&#230;");
      entities.put("Agrave","&#192;");
      entities.put("agrave","&#224;");
      entities.put("amp","&#38;");
      entities.put("Aring","&#197;");
      entities.put("aring","&#229;");
      entities.put("Atilde","&#195;");
      entities.put("atilde","&#227;");
      entities.put("Auml","&#196;");
      entities.put("auml","&#228;");
      entities.put("Ccedil","&#199;");
      entities.put("ccedil","&#231;");
      entities.put("Eacute","&#201;");
      entities.put("eacute","&#233;");
      entities.put("Ecirc","&#202;");
      entities.put("ecirc","&#234;");
      entities.put("Egrave","&#200;");
      entities.put("egrave","&#232;");
      entities.put("ETH","&#208;");
      entities.put("eth","&#240;");
      entities.put("Euml","&#203;");
      entities.put("euml","&#235;");
      entities.put("gt","&#62;");
      entities.put("Iacute","&#205;");
      entities.put("iacute","&#237;");
      entities.put("Icirc","&#206;");
      entities.put("icirc","&#238;");
      entities.put("Igrave","&#204;");
      entities.put("igrave","&#236;");
      entities.put("Iuml","&#207;");
      entities.put("iuml","&#239;");
      entities.put("lt","&#60;");
      entities.put("Ntilde","&#209;");
      entities.put("ntilde","&#241;");
      entities.put("Oacute","&#211;");
      entities.put("oacute","&#243;");
      entities.put("Ocirc","&#212;");
      entities.put("ocirc","&#244;");
      entities.put("Ograve","&#210;");
      entities.put("ograve","&#242;");
      entities.put("Oslash","&#216;");
      entities.put("oslash","&#248;");
      entities.put("Otilde","&#213;");
      entities.put("otilde","&#245;");
      entities.put("Ouml","&#214;");
      entities.put("ouml","&#246;");
      entities.put("quot","&#34;");
      entities.put("szlig","&#223;");
      entities.put("THORN","&#222;");
      entities.put("thorn","&#254;");
      entities.put("Uacute","&#218;");
      entities.put("uacute","&#250;");
      entities.put("Ucirc","&#219;");
      entities.put("ucirc","&#251;");
      entities.put("Ugrave","&#217;");
      entities.put("ugrave","&#249;");
      entities.put("Uuml","&#220;");
      entities.put("uuml","&#252;");
      entities.put("Yacute","&#221;");
      entities.put("yacute","&#253;");
      entities.put("yuml","&#255;");
      entities.put("acute","&#180;");
      entities.put("brvbar","&#166;");
      entities.put("cedil","&#184;");
      entities.put("cent","&#162;");
      entities.put("copy","&#169;");
      entities.put("curren","&#164;");
      entities.put("deg","&#176;");
      entities.put("divide","&#247;");
      entities.put("frac12","&#189;");
      entities.put("frac14","&#188;");
      entities.put("frac34","&#190;");
      entities.put("iexcl","&#161;");
      entities.put("iquest","&#191;");
      entities.put("laquo","&#171;");
      entities.put("macr","&#175;");
      entities.put("micro","&#181;");
      entities.put("middot","&#183;");
      entities.put("nbsp","&#160;");
      entities.put("not","&#172;");
      entities.put("ordf","&#170;");
      entities.put("ordm","&#186;");
      entities.put("para","&#182;");
      entities.put("plusmn","&#177;");
      entities.put("pound","&#163;");
      entities.put("raquo","&#187;");
      entities.put("reg","&#174;");
      entities.put("sect","&#167;");
      entities.put("shy","&#173;");
      entities.put("sup1","&#185;");
      entities.put("sup2","&#178;");
      entities.put("sup3","&#179;");
      entities.put("times","&#215;");
      entities.put("uml","&#168;");
      entities.put("yen","&#165;");
      entities.put("alefsym","&#8501;");
      entities.put("Alpha","&#913;");
      entities.put("alpha","&#945;");
      entities.put("and","&#8743;");
      entities.put("ang","&#8736;");
      entities.put("asymp","&#8776;");
      entities.put("bdquo","&#8222;");
      entities.put("Beta","&#914;");
      entities.put("beta","&#946;");
      entities.put("bull","&#8226;");
      entities.put("cap","&#8745;");
      entities.put("Chi","&#935;");
      entities.put("chi","&#967;");
      entities.put("circ","&#710;");
      entities.put("clubs","&#9827;");
      entities.put("cong","&#8773;");
      entities.put("crarr","&#8629;");
      entities.put("cup","&#8746;");
      entities.put("dagger","&#8224;");
      entities.put("Dagger","&#8225;");
      entities.put("darr","&#8595;");
      entities.put("dArr","&#8659;");
      entities.put("Delta","&#916;");
      entities.put("delta","&#948;");
      entities.put("diams","&#9830;");
      entities.put("empty","&#8709;");
      entities.put("emsp","&#8195;");
      entities.put("ensp","&#8194;");
      entities.put("Epsilon","&#917;");
      entities.put("epsilon","&#949;");
      entities.put("equiv","&#8801;");
      entities.put("Eta","&#919;");
      entities.put("eta","&#951;");
      entities.put("euro","&#8364;");
      entities.put("exist","&#8707;");
      entities.put("fnof","&#402;");
      entities.put("forall","&#8704;");
      entities.put("frasl","&#8260;");
      entities.put("Gamma","&#915;");
      entities.put("gamma","&#947;");
      entities.put("ge","&#8805;");
      entities.put("harr","&#8596;");
      entities.put("hArr","&#8660;");
      entities.put("hearts","&#9829;");
      entities.put("hellip","&#8230;");
      entities.put("image","&#8465;");
      entities.put("infin","&#8734;");
      entities.put("int","&#8747;");
      entities.put("Iota","&#921;");
      entities.put("iota","&#953;");
      entities.put("isin","&#8712;");
      entities.put("Kappa","&#922;");
      entities.put("kappa","&#954;");
      entities.put("Lambda","&#923;");
      entities.put("lambda","&#955;");
      entities.put("lang","&#9001;");
      entities.put("larr","&#8592;");
      entities.put("lArr","&#8656;");
      entities.put("lceil","&#8968;");
      entities.put("ldquo","&#8220;");
      entities.put("le","&#8804;");
      entities.put("lfloor","&#8970;");
      entities.put("lowast","&#8727;");
      entities.put("loz","&#9674;");
      entities.put("lrm","&#8206;");
      entities.put("lsaquo","&#8249;");
      entities.put("lsquo","&#8216;");
      entities.put("mdash","&#8212;");
      entities.put("minus","&#8722;");
      entities.put("Mu","&#924;");
      entities.put("mu","&#956;");
      entities.put("nabla","&#8711;");
      entities.put("ndash","&#8211;");
      entities.put("ne","&#8800;");
      entities.put("ni","&#8715;");
      entities.put("notin","&#8713;");
      entities.put("nsub","&#8836;");
      entities.put("Nu","&#925;");
      entities.put("nu","&#957;");
      entities.put("OElig","&#338;");
      entities.put("oelig","&#339;");
      entities.put("oline","&#8254;");
      entities.put("Omega","&#937;");
      entities.put("omega","&#969;");
      entities.put("Omicron","&#927;");
      entities.put("omicron","&#959;");
      entities.put("oplus","&#8853;");
      entities.put("or","&#8744;");
      entities.put("otimes","&#8855;");
      entities.put("part","&#8706;");
      entities.put("permil","&#8240;");
      entities.put("perp","&#8869;");
      entities.put("Phi","&#934;");
      entities.put("phi","&#966;");
      entities.put("Pi","&#928;");
      entities.put("pi","&#960;");
      entities.put("piv","&#982;");
      entities.put("prime","&#8242;");
      entities.put("Prime","&#8243;");
      entities.put("prod","&#8719;");
      entities.put("prop","&#8733;");
      entities.put("Psi","&#936;");
      entities.put("psi","&#968;");
      entities.put("radic","&#8730;");
      entities.put("rang","&#9002;");
      entities.put("rarr","&#8594;");
      entities.put("rArr","&#8658;");
      entities.put("rceil","&#8969;");
      entities.put("rdquo","&#8221;");
      entities.put("real","&#8476;");
      entities.put("rfloor","&#8971;");
      entities.put("Rho","&#929;");
      entities.put("rho","&#961;");
      entities.put("rlm","&#8207;");
      entities.put("rsaquo","&#8250;");
      entities.put("rsquo","&#8217;");
      entities.put("sbquo","&#8218;");
      entities.put("Scaron","&#352;");
      entities.put("scaron","&#353;");
      entities.put("sdot","&#8901;");
      entities.put("Sigma","&#931;");
      entities.put("sigma","&#963;");
      entities.put("sigmaf","&#962;");
      entities.put("sim","&#8764;");
      entities.put("spades","&#9824;");
      entities.put("sub","&#8834;");
      entities.put("sube","&#8838;");
      entities.put("sum","&#8721;");
      entities.put("sup","&#8835;");
      entities.put("supe","&#8839;");
      entities.put("Tau","&#932;");
      entities.put("tau","&#964;");
      entities.put("there4","&#8756;");
      entities.put("Theta","&#920;");
      entities.put("theta","&#952;");
      entities.put("thetasym","&#977;");
      entities.put("thinsp","&#8201;");
      entities.put("tilde","&#732;");
      entities.put("trade","&#8482;");
      entities.put("uarr","&#8593;");
      entities.put("uArr","&#8657;");
      entities.put("upsih","&#978;");
      entities.put("Upsilon","&#933;");
      entities.put("upsilon","&#965;");
      entities.put("weierp","&#8472;");
      entities.put("Xi","&#926;");
      entities.put("xi","&#958;");
      entities.put("Yuml","&#376;");
      entities.put("Zeta","&#918;");
      entities.put("zeta","&#950;");
      entities.put("zwj","&#8205;");
      entities.put("zwnj","&#8204;");
      entities.put("apos","&#39;");
   }


   /**
    * Cleans up the object when it's destroyed.
    */
   protected void finalize()
      throws Throwable
   {
      this.entities.clear();
      this.entities = null;
      super.finalize();
   }


   /**
    * Adds an internal entity.
    *
    * @param name the name of the entity.
    * @param value the value of the entity.
    */
   public void addInternalEntity(String name,
                                 String value)
   {
      if (! this.entities.containsKey(name)) {
         this.entities.put(name, value);
      }
   }


   /**
    * Adds an external entity.
    *
    * @param name the name of the entity.
    * @param publicID the public ID of the entity, which may be null.
    * @param systemID the system ID of the entity.
    */
   public void addExternalEntity(String name,
                                 String publicID,
                                 String systemID)
   {
      if (! this.entities.containsKey(name)) {
         this.entities.put(name, new String[] { publicID, systemID } );
      }
   }


   /**
    * Returns a Java reader containing the value of an entity.
    *
    * @param xmlReader the current XML reader
    * @param name the name of the entity.
    *
    * @return the reader, or null if the entity could not be resolved.
    */
   public Reader getEntity(NanoXMLReader xmlReader,
                           String     name)
      throws XMLParseException
   {
      Object obj = this.entities.get(name);

      if (obj == null) {
         return null;
      } else if (obj instanceof java.lang.String) {
         return new StringReader((String)obj);
      } else {
         String[] id = (String[]) obj;
         return this.openExternalEntity(xmlReader, id[0], id[1]);
      }
   }


   /**
    * Returns true if an entity is external.
    *
    * @param name the name of the entity.
    */
   public boolean isExternalEntity(String name)
   {
      Object obj = this.entities.get(name);
      return ! (obj instanceof java.lang.String);
   }


   /**
    * Opens an external entity.
    *
    * @param xmlReader the current XML reader
    * @param publicID the public ID, which may be null
    * @param systemID the system ID
    *
    * @return the reader, or null if the reader could not be created/opened
    */
   protected Reader openExternalEntity(NanoXMLReader xmlReader,
                                       String     publicID,
                                       String     systemID)
      throws XMLParseException
   {
	   // danID modification. We do not want to resolve external entities.
	   return null;
   }

}
